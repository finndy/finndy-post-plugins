<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>finndyAPI</title>
	<link href="http://cdn.bootcss.com/bootstrap/4.0.0-alpha.3/css/bootstrap.css" rel="stylesheet">
	<script src="http://cdn.bootcss.com/jquery/3.1.0/jquery.min.js"></script>

</head>
<body>

	<div class="form-group">
    <label for="exampleInputPassword1">Token</label>
    <input type="txt" class="form-control" id="token" placeholder="token" name="token" value="finndyToken">
  	</div>

  	<div class="form-group">
    <label for="exampleInputPassword1">title</label>
    <input type="txt" class="form-control" id="title" placeholder="title" name="title">
  	</div>
  	<div class="form-group">
    <label for="exampleInputPassword1">detail</label>
    <input type="txt" class="form-control" id="detail" placeholder="detail" name="detail">
  	</div>
  	<div class="form-group">
    <label for="exampleInputPassword1">author</label>
    <input type="txt" class="form-control" id="author" placeholder="author" name="author">
  	</div>
  	<div class="form-group">
    <label for="exampleInputPassword1">time</label>
    <input type="txt" class="form-control" id="time" placeholder="time" name="time">
  	</div>

  	<select class="form-control" id="forums">
	  <option >默认模块</option>
	</select>
	<div class="form-group">
    <div class="col-sm-offset-2 col-sm-10">
      <div class="checkbox">
        <label>
          <input type="checkbox" value="1" id="audit" checked>需要审核
        </label>
      </div>
    </div>
  </div>
<div class="form-group">
    <div class="col-sm-offset-2 col-sm-10">
	 <button type="submit" class="btn btn-default" onclick="_submit()">Submit</button>
  </div>
 </div>
	<script>
	/*test = true;
	if (test) {
		url =  'http://localhost/discuz/upload';
	}else{
		url = 'http://test.finndy.com';
	}
	$(function(){
		var token = $('#token').val();		
		$.get(url+'/plugin.php?id=finndy:interface&type=category&token='+token,function(res){
			if (res) {
				//console.log(res);
				var str = '';
				$.each(res,function(k,v){
					str += '<option value="'+v.id+'">'+v.name+'</option>';
				});
				$('#forums').html(str);
			}else{
				alert('fail');
			}
		},'json');
	});

	{"article_title":"","article_content":"","article_author":"","article_topics":"[]","article_publish_time":"1450836600","__sign":"shenjianshou.cn","diz_username":"admin","diz_password":"123456","diz_question":"0","diz_answer":"","webroot":"test.finndy.com","sign":"shenjianshou.cn","default_forum":"1","min_time":"","default_password":"","use_authors":"","default_group":"","enableTitleReplace":"","enableReplaceLink":"","defineHyperlink":"javascript:void(0)"}


	function _submit(){
		var token = $('#token').val();
		var title = $('#title').val();
		var detail = $('#detail').val();
		var author = $('#author').val();
		var time = $('#time').val();
		var audit = $('#audit').is(':checked');
		
		var forums = $('#forums').find("option:selected").val();
		$.post(url+'/plugin.php?id=finndy:interface&type=catedata&token='+token,{article_title:title,article_content:detail,article_author:author,article_publish_time:time,default_forum:forums},function(res){
			if (res) {
				console.log(res);
				
			}else{
				alert('fail');
			}
		},'json');
		
	}*/

	url = 'http://localhost/phpwind/upload/index.php?app=finndy&m=app&c=index&a=details';

	$(function(){
		var token = $('#token').val();		
		$.post(url,{token:token},function(res){
			if (res.status) {
				console.log(res);
				var str = '';
				$.each(res.data,function(k,v){
					str += '<option value="'+v.id+'">'+v.name+'</option>';
				});
				$('#forums').html(str);
			}else{
				alert('fail');
			}
		},'json');
	});

	function _submit(){
		var token = $('#token').val();
		var title = $('#title').val();
		var detail = $('#detail').val();
		var author = $('#author').val();
		var time = $('#time').val();
		var audit = $('#audit').is(':checked');
		var forums = $('#forums').find("option:selected").val();
		$.post('http://localhost/phpwind/upload/index.php?app=finndy&m=app&c=index&a=post',{token:token,question_title:title,question_detail:detail,question_author:author,question_publish_time:time,question_categories:forums},function(res){
			if (res) {
				console.log(res);
				
			}else{
				alert('fail');
			}
		},'json');
	};





	</script>
</body>
</html>